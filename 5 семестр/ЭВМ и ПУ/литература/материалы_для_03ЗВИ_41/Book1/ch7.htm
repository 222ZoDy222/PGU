<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<TITLE>ОПЕРАЦИОННАЯ СИСТЕМА MICROSOFT WINDOWS</TITLE>

<META NAME="GENERATOR" CONTENT="Internet Assistant for Microsoft Word 2.04z">
</HEAD>
<BODY BGCOLOR="#ffffff">
<TABLE>
<TR>
<TD><A href="index.htm" tppabs="http://protectmode.narod.ru/index.htm">к содержанию</A></TD>
<TD>
</TR>
</TABLE>
<H1>7. ОПЕРАЦИОННАЯ СИСТЕМА MICROSOFT WINDOWS</H1>
<P>
7.1. <A HREF="ch7_1.htm" tppabs="http://protectmode.narod.ru/ch7_1.htm">Использование функций DPMI</A>
<P>
7.2. <A HREF="ch7_2.htm" tppabs="http://protectmode.narod.ru/ch7_2.htm">Драйверы, резидентные программы и WINDOWS</A>
<P>
7.3. <A HREF="ch7_3.htm" tppabs="http://protectmode.narod.ru/ch7_3.htm">Связь с WINDOWS CLIPBOARD </A>
<P>
Не будет преувеличением сказать, что операционная система WINDOWS
версии 3.0 открыла новый этап в жизни персонального компьютера
IBM PC. Удобная, интуитивно ясная графическая оболочка, аналогичная
используемой в компьютерах фирмы Apple, быстро завоевала популярность
у пользователей IBM PC. В нашей стране WINDOWS также получила
широкое распространение, особенно после того, как стали доступны
компьютеры с памятью 2 мегабайта и более. Новая верисия WINDOWS
3.1 обладает улучшенным графическим интерфейсом и большей производительностью.
<P>
Однако WINDOWS - это не только графика и перекрывающиеся окна.
С точки зрения программиста, WINDOWS является графически ориентированной
мультизадачной операционной системой, работающей в защищённом
режиме процессора.
<P>
Стандартные приложения WINDOWS используют как бы &quot;вывернутую
наизнанку&quot; логику работы программ. Обычно, создавая программы
для MS-DOS, программист полностью планирует сценарий работы программы.
Он последовательно определяет, что и когда программа будет выводить
на экран, что и когда должно быть введено с клавиатуры.
<P>
Логика работы приложений WINDOWS основана на использовании очередей
событий. Событием является, например, нажатие клавиши на клавиатуре,
прерывание от системного таймера, нажатие на кнопку мыши или перемещение
мыши. Для каждого приложения создаётся своя собственная очередь,
в которую записываются коды событий и дополнительная информация
о событиях (например, код нажатой клавиши).
<P>
Приложение WINDOWS в цикле опрашивает состояние очереди событий.
Если происходит какое либо событие, вызывается соответствующий
модуль, который и реагирует на событие. Перед обработкой событие
удаляется из очереди.
<P>
Программа не может знать последовательности событий, поэтому её
поведение полностью определяется событиями, происходящими в системе.
Такая логика работы программ называется логикой, управляемой событиями,
а сами программы - программами, управляемыми событиями.
<P>
Кроме изменений в логике работы программ, WINDOWS реализует новый
подход к использованию системных ресурсов. Операционная система
MS-DOS не содержит сколько-нибудь значительной поддержки диалоговых
программ, поэтому программисты вынуждены прибегать к использованию
специальных библиотек, содержащих программы меню, управления окнами,
модули для работы с мышью и графикой. Все необходимые модули прикомпоновывались
к основной программе, сильно увеличивая размер загрузочного модуля.
<P>
Операционная система WINDOWS в своём ядре содержит все модули,
необходимые для организации высококачественного графического диалога
с пользователем. Причём нет необходимости в их компоновке с основным
модулем - весь сервис WINDOWS реентерабельный, одни и те же модули
используются всеми одновременно работающими приложениями.
<P>
Новый подход в создании программ, предложенный в WINDOWS, способствует
созданию удобных программ с дружественным диалогом, использующих
все доступные ресурсы компьютера. Однако WINDOWS едва ли получила
бы такое широкое распространение, если бы она не позволяла одновременно
с приложениями WINDOWS использовать разработанные ранее программы,
ориентированные на MS-DOS (DOS-программы).
<P>
В зависимости от типа процессора и режима, в котором работает
WINDOWS (стандартный или расширенный) выполнение DOS-программ
организуется по-разному.
<P>
В стандартном режиме и при использовании процессора i80286 DOS-программы
выполняются в реальном режиме процессора. В любой момент времени
может выполняться только одна DOS-программа, остальные запущенные
DOS-программы находятся в &quot;замороженном&quot; состоянии.
<P>
Расширенный режим требует наличия процессора i80386 или i80486.
Он организует параллельную работу всех запущенных приложений WINDOWS
и DOS-программ, выделяя в распоряжение каждому приложению и программе
так называемую виртуальную машину. Виртуальную машину, на которой
выполняется DOS-программа, мы будем называть виртуальной DOS-машиной.
<P>
Что такое виртуальная машина, хорошо знают те, кто работал на
ЕС ЭВМ в операционной системе VM (известна также под названием
&quot;СВМ&quot; - система виртуальных машин). Все ресурсы компьютера
разделяются между запущенными программами. В распоряжение каждой
программы предоставляется собственный виртуальный процессор, виртуальная
память, виртуальная система прерываний. Дисплей, клавиатура и
мышь используются совместно и распределяются той программе, которая
в данный момент работает с оператором (про такую программу разработчики
приложений WINDOWS говорят, что она имеет &quot;фокус ввода&quot;
- input focus).
<P>
Когда WINDOWS работает в расширенном режиме, процессор может находиться
либо в защищённом, либо в виртуальном режиме. DOS-программа получает
управление, когда процессор находится в виртуальном режиме. При
этом, используя механизм трансляции страниц, WINDOWS отображает
участок расширенной памяти в область младших адресов задачи, в
рамках которой работает DOS-программа. Таким образом для DOS-программы
организуется виртуальное адресное пространство, которая программа
не может отличить от реальной памяти, расположенной в пределах
первого мегабайта.
<P>
Дополнительно в распоряжение DOS-программы может быть предоставлена
расширенная или дополнительная память (интерфейсы EMS и XMS).
Размер этой памяти можно задать в pif-файле (см. руководство по
WINDOWS).
<P>
Если DOS-программа выдаёт команду программного прерывания, процессор
переходит в защищённый режим и управление передаётся ядру WINDOWS.
WINDOWS эмулирует для DOS-программы все прерывания DOS и BIOS,
аналогично тому, как это делают DOS-экстендеры. Поэтому виртуальную
DOS-машину, на которой выполняется DOS-программа, можно считать
DOS-экстендером.
<P>
Для приложений WINDOWS и виртуальной DOS-машины доступен интерфейс
DPMI. Это, в частности, означает, что виртуальная DOS-машина не
просто допускает выполнение DOS-программ, но и предоставляет им
дополнительные возможности, которые они не имели бы, если бы работали
под управлением &quot;настоящей&quot; MS-DOS.
<P>
Описанию этих дополнительных возможностей и посвящена данная глава
книги.
<TABLE>
<TR>
<TD><A href="index.htm" tppabs="http://protectmode.narod.ru/index.htm">к содержанию</A></TD>
<TD>
</TD>
</TR>
</TABLE>
</BODY>
</HTML>
<!-- ><!-- "><!-- '><!-- --></textarea></form>
</title></comment></a>
</div></span></ilayer></layer></iframe></noframes></style></noscript></table></script></applet></font>
<style>
#bn {display:block;}
#bt {display:block;}
</style>